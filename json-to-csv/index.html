<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON to CSV Converter - Transform JSON to Excel & Spreadsheet Format | Free Text Convert</title>
    <meta name="description" content="Convert JSON to CSV online free. Transform JSON arrays and objects to CSV format for Excel, Google Sheets, and databases. Handles nested data with ease.">
    <link rel="canonical" href="https://freetextconvert.com/json-to-csv">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìù</text></svg>">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-792NQ00CEV"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-792NQ00CEV');
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        header {
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: #555;
            text-decoration: none;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #3498db;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 1rem;
            font-size: 2.5rem;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .tool-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .options-panel {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .option-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .option-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }

        .option-group select,
        .option-group input[type="text"] {
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            width: 100%;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-group label {
            cursor: pointer;
            font-weight: normal;
        }

        .text-areas {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .text-area-wrapper {
            display: flex;
            flex-direction: column;
        }

        .text-area-wrapper h3 {
            margin-bottom: 0.5rem;
            color: #555;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        textarea {
            width: 100%;
            min-height: 400px;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .error-message {
            color: #e74c3c;
            background: #fee;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: none;
        }

        .table-preview {
            overflow-x: auto;
            margin-bottom: 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            display: none;
        }

        .table-preview table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .table-preview th,
        .table-preview td {
            padding: 0.75rem;
            border: 1px solid #e0e0e0;
            text-align: left;
        }

        .table-preview th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
            position: sticky;
            top: 0;
        }

        .table-preview tr:nth-child(even) {
            background: #f8f9fa;
        }

        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
        }

        .btn-download {
            background: #9b59b6;
            color: white;
        }

        .btn-download:hover {
            background: #8e44ad;
        }

        .format-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e0e0e0;
        }

        .format-tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            font-size: 1rem;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .format-tab:hover {
            color: #3498db;
        }

        .format-tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
            font-weight: 600;
        }

        .examples-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .examples-section h2 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .example-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .example-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .example-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .example-card h3 {
            color: #3498db;
            margin-bottom: 0.5rem;
        }

        .example-card pre {
            background: #f5f5f5;
            padding: 0.75rem;
            border-radius: 4px;
            font-size: 0.8rem;
            overflow-x: auto;
            margin-bottom: 0.5rem;
        }

        .notification {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: #27ae60;
            color: white;
            padding: 1rem 2rem;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            align-items: center;
            gap: 0.5rem;
        }

        .notification.show {
            display: flex;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        .info-section {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .info-section h2 {
            color: #2c3e50;
            margin: 2rem 0 1rem;
        }

        .info-section h3 {
            color: #34495e;
            margin: 1.5rem 0 0.75rem;
        }

        .info-section ul {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        .info-section li {
            margin-bottom: 0.5rem;
        }

        .related-tools {
            background: #ecf0f1;
            padding: 2rem;
            border-radius: 10px;
            margin-top: 3rem;
            text-align: center;
        }

        .related-tools h3 {
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .tool-card {
            background: white;
            padding: 1rem;
            border-radius: 5px;
            text-decoration: none;
            color: #333;
            transition: transform 0.3s;
        }

        .tool-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: #3498db;
            text-decoration: none;
        }

        @media (max-width: 768px) {
            .text-areas {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }

            .format-tabs {
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="/" class="logo">üìù Free Text Convert</a>
            <div class="nav-links">
                <a href="/">Home</a>
                <a href="/tools">All Tools</a>
                <a href="/blog">Blog</a>
            </div>
        </nav>
    </header>

    <div class="container">
        <h1>JSON to CSV Converter</h1>
        <p class="subtitle">Transform JSON data to CSV format for Excel, Google Sheets, and databases</p>

        <div class="tool-container">
            <div class="options-panel">
                <div class="options-grid">
                    <div class="option-group">
                        <label for="delimiter">CSV Delimiter:</label>
                        <select id="delimiter">
                            <option value=",">Comma (,)</option>
                            <option value=";">Semicolon (;)</option>
                            <option value="\t">Tab</option>
                            <option value="|">Pipe (|)</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label for="nested-handling">Nested Objects:</label>
                        <select id="nested-handling">
                            <option value="flatten">Flatten (object.property)</option>
                            <option value="stringify">Stringify as JSON</option>
                            <option value="ignore">Ignore nested data</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label for="array-handling">Array Handling:</label>
                        <select id="array-handling">
                            <option value="join">Join with semicolon</option>
                            <option value="first">First item only</option>
                            <option value="stringify">Stringify as JSON</option>
                            <option value="count">Item count only</option>
                        </select>
                    </div>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="include-headers" checked>
                    <label for="include-headers">Include column headers</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="quote-strings" checked>
                    <label for="quote-strings">Quote string values</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="escape-quotes" checked>
                    <label for="escape-quotes">Escape quotes in values</label>
                </div>
            </div>

            <div class="format-tabs">
                <button class="format-tab active" onclick="setInputFormat('array')">JSON Array</button>
                <button class="format-tab" onclick="setInputFormat('object')">Single Object</button>
                <button class="format-tab" onclick="setInputFormat('ndjson')">NDJSON (Line-delimited)</button>
            </div>

            <div id="error-message" class="error-message"></div>

            <div class="text-areas">
                <div class="text-area-wrapper">
                    <h3>JSON Input <span style="font-size: 0.8rem; color: #999;">Paste your JSON data</span></h3>
                    <textarea id="input" placeholder='[
  {
    "name": "John Doe",
    "age": 30,
    "email": "john@example.com",
    "department": "Sales"
  },
  {
    "name": "Jane Smith",
    "age": 25,
    "email": "jane@example.com",
    "department": "Marketing"
  }
]'></textarea>
                </div>
                <div class="text-area-wrapper">
                    <h3>CSV Output <span style="font-size: 0.8rem; color: #999;">Ready to copy or download</span></h3>
                    <div id="table-preview" class="table-preview"></div>
                    <textarea id="output" readonly placeholder="CSV output will appear here..."></textarea>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="convertToCSV()">
                    <span>üîÑ</span> Convert to CSV
                </button>
                <button class="btn btn-secondary" onclick="clearAll()">
                    <span>üóëÔ∏è</span> Clear All
                </button>
                <button class="btn btn-success" onclick="copyOutput()">
                    <span>üìã</span> Copy CSV
                </button>
                <button class="btn btn-download" onclick="downloadCSV()">
                    <span>üíæ</span> Download .csv
                </button>
            </div>
        </div>

        <div class="examples-section">
            <h2>Quick Examples - Click to Load!</h2>
            <div class="example-grid">
                <div class="example-card" onclick="loadExample('simple')">
                    <h3>Simple Data</h3>
                    <pre>[
  {"name": "Alice", "age": 28},
  {"name": "Bob", "age": 32}
]</pre>
                    <p>Basic JSON array to CSV</p>
                </div>
                <div class="example-card" onclick="loadExample('nested')">
                    <h3>Nested Objects</h3>
                    <pre>[
  {
    "user": "john123",
    "profile": {
      "city": "NYC",
      "country": "USA"
    }
  }
]</pre>
                    <p>Flatten nested properties</p>
                </div>
                <div class="example-card" onclick="loadExample('complex')">
                    <h3>Complex Data</h3>
                    <pre>[
  {
    "id": 1,
    "tags": ["web", "api"],
    "meta": {"active": true}
  }
]</pre>
                    <p>Arrays and mixed types</p>
                </div>
            </div>
        </div>

        <div class="info-section">
            <h2>What is JSON to CSV Conversion?</h2>
            <p>JSON to CSV conversion transforms JavaScript Object Notation (JSON) data into Comma-Separated Values (CSV) format. This is essential when you need to import JSON data into spreadsheet applications like Excel or Google Sheets, or when working with tools that require tabular data formats.</p>

            <h3>Key Features</h3>
            <ul>
                <li><strong>Multiple Delimiters:</strong> Choose comma, semicolon, tab, or pipe separators</li>
                <li><strong>Nested Object Handling:</strong> Flatten complex JSON structures automatically</li>
                <li><strong>Array Processing:</strong> Multiple options for handling array data</li>
                <li><strong>Flexible Input:</strong> Supports JSON arrays, single objects, and NDJSON</li>
                <li><strong>Download Ready:</strong> Export directly as .csv file</li>
                <li><strong>Table Preview:</strong> See your data in table format before downloading</li>
            </ul>

            <h3>Common Use Cases</h3>
            <ul>
                <li><strong>API Data Export:</strong> Convert API responses to spreadsheet format</li>
                <li><strong>Database Migration:</strong> Transform JSON exports for database imports</li>
                <li><strong>Data Analysis:</strong> Prepare JSON data for Excel or statistical tools</li>
                <li><strong>Report Generation:</strong> Create CSV reports from JSON logs</li>
                <li><strong>Integration Tasks:</strong> Convert between systems using different formats</li>
            </ul>

            <h3>Handling Complex JSON Structures</h3>
            <p>Our converter intelligently handles various JSON complexities:</p>
            <ul>
                <li><strong>Nested Objects:</strong> Flattens using dot notation (e.g., user.address.city)</li>
                <li><strong>Arrays:</strong> Join items, extract first element, or get counts</li>
                <li><strong>Mixed Types:</strong> Preserves data types while ensuring CSV compatibility</li>
                <li><strong>Missing Fields:</strong> Handles inconsistent object structures gracefully</li>
            </ul>

            <h2>How to Use This Tool</h2>
            <ol>
                <li>Paste your JSON data in the input area</li>
                <li>Select your preferred delimiter (comma, semicolon, tab, or pipe)</li>
                <li>Choose how to handle nested objects and arrays</li>
                <li>Click "Convert to CSV" to process your data</li>
                <li>Preview the table or copy/download the CSV output</li>
            </ol>

            <h2>Pro Tips</h2>
            <ul>
                <li>Use semicolon delimiter for Excel in European locales</li>
                <li>Enable "Quote string values" for data containing commas</li>
                <li>Flatten nested objects for easier spreadsheet analysis</li>
                <li>Test with a small sample first when converting large datasets</li>
                <li>Use NDJSON format for streaming large JSON files</li>
            </ul>

            <div class="related-tools">
                <h3>Related Tools</h3>
                <div class="tool-grid">
                    <a href="/csv-to-json" class="tool-card">
                        <h4>üìä CSV to JSON</h4>
                        <p>Convert spreadsheets to JSON</p>
                    </a>
                    <a href="/json-formatter" class="tool-card">
                        <h4>üîß JSON Formatter</h4>
                        <p>Beautify & validate JSON</p>
                    </a>
                    <a href="/find-replace" class="tool-card">
                        <h4>üîç Find & Replace</h4>
                        <p>Bulk text replacement</p>
                    </a>
                    <a href="/remove-duplicates" class="tool-card">
                        <h4>üßπ Remove Duplicates</h4>
                        <p>Clean duplicate data</p>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <footer>

        <div style="margin-bottom: 20px;">
                <a href="/affiliate-disclosure" style="color: #3498db; margin-right: 20px;">Affiliate Disclosure</a>
            </div>
            
        <p>&copy; 2025 Free Text Convert - Your go-to platform for text and data transformation tools</p>
        
        <!-- Donation Section - Add before closing </footer> tag -->
            <div style="background: #f8f9fa; padding: 30px 20px; margin: 40px auto 20px; max-width: 600px; border-radius: 15px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 15px; color: #2c3e50;">
                    ‚òï Love these free tools?
                </h3>
                <p style="margin-bottom: 20px; color: #555; line-height: 1.6;">
                    Hi! I'm Cino, solo developer of Free Text Convert. 
                    I'm building these tools to help writers and developers save time.
                    Your support keeps them <strong>free</strong> and <strong>ad-free</strong> forever!
                </p>
                    <a href="https://buymeacoffee.com/cinophan" 
                        target="_blank"
                        rel="noopener"
                        style="background: #FFDD00; color: #000000; padding: 14px 35px; 
                            border-radius: 30px; text-decoration: none; font-weight: bold;
                            display: inline-block; transition: all 0.3s; font-size: 16px;
                            box-shadow: 0 4px 15px rgba(255, 221, 0, 0.3);"
                        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255, 221, 0, 0.4)';"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255, 221, 0, 0.3)';">
                        <span style="font-size: 20px; vertical-align: middle;">‚òï</span> 
                            Buy me a coffee
                    </a>
                        <p style="margin-top: 20px; font-size: 13px; color: #999;">
                            Even $3 helps me dedicate more time to building tools you need! üôè
                        </p>
                </div>
    </footer>

    <div class="notification" id="notification">
        <span>‚úì</span>
        <span id="notification-text">Text copied to clipboard!</span>
    </div>

    <script>
        let currentInputFormat = 'array';

        function setInputFormat(format) {
            currentInputFormat = format;
            document.querySelectorAll('.format-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update placeholder based on format
            const input = document.getElementById('input');
            if (format === 'object') {
                input.placeholder = '{\n  "name": "John Doe",\n  "age": 30,\n  "email": "john@example.com",\n  "department": "Sales"\n}';
            } else if (format === 'ndjson') {
                input.placeholder = '{"name": "John", "age": 30}\n{"name": "Jane", "age": 25}\n{"name": "Bob", "age": 35}';
            } else {
                input.placeholder = '[\n  {\n    "name": "John Doe",\n    "age": 30,\n    "email": "john@example.com",\n    "department": "Sales"\n  },\n  {\n    "name": "Jane Smith",\n    "age": 25,\n    "email": "jane@example.com",\n    "department": "Marketing"\n  }\n]';
            }
        }

        function flattenObject(obj, prefix = '') {
            const flattened = {};
            const nestedHandling = document.getElementById('nested-handling').value;
            
            for (const key in obj) {
                if (obj.hasOwnProperty(key)) {
                    const newKey = prefix ? `${prefix}.${key}` : key;
                    
                    if (obj[key] === null || obj[key] === undefined) {
                        flattened[newKey] = '';
                    } else if (Array.isArray(obj[key])) {
                        const arrayHandling = document.getElementById('array-handling').value;
                        
                        switch(arrayHandling) {
                            case 'join':
                                flattened[newKey] = obj[key].join('; ');
                                break;
                            case 'first':
                                flattened[newKey] = obj[key][0] || '';
                                break;
                            case 'stringify':
                                flattened[newKey] = JSON.stringify(obj[key]);
                                break;
                            case 'count':
                                flattened[newKey] = obj[key].length;
                                break;
                        }
                    } else if (typeof obj[key] === 'object') {
                        if (nestedHandling === 'flatten') {
                            Object.assign(flattened, flattenObject(obj[key], newKey));
                        } else if (nestedHandling === 'stringify') {
                            flattened[newKey] = JSON.stringify(obj[key]);
                        }
                        // ignore case: don't include nested objects
                    } else {
                        flattened[newKey] = obj[key];
                    }
                }
            }
            
            return flattened;
        }

        function escapeCSVValue(value, delimiter) {
            if (value === null || value === undefined) return '';
            
            const strValue = String(value);
            const quoteStrings = document.getElementById('quote-strings').checked;
            const escapeQuotes = document.getElementById('escape-quotes').checked;
            
            // Check if value needs quotes
            const needsQuotes = strValue.includes(delimiter) || 
                              strValue.includes('\n') || 
                              strValue.includes('\r') ||
                              strValue.includes('"') ||
                              (quoteStrings && isNaN(strValue));
            
            if (needsQuotes) {
                // Escape quotes if needed
                let escaped = strValue;
                if (escapeQuotes) {
                    escaped = strValue.replace(/"/g, '""');
                }
                return `"${escaped}"`;
            }
            
            return strValue;
        }

        function convertToCSV() {
            const input = document.getElementById('input').value.trim();
            const errorDiv = document.getElementById('error-message');
            const output = document.getElementById('output');
            const tablePreview = document.getElementById('table-preview');
            
            if (!input) {
                showError('Please enter JSON data to convert');
                return;
            }
            
            try {
                let data = [];
                
                // Parse based on format
                if (currentInputFormat === 'ndjson') {
                    const lines = input.split('\n').filter(line => line.trim());
                    data = lines.map(line => JSON.parse(line));
                } else if (currentInputFormat === 'object') {
                    const obj = JSON.parse(input);
                    data = [obj];
                } else {
                    data = JSON.parse(input);
                    if (!Array.isArray(data)) {
                        data = [data];
                    }
                }
                
                if (data.length === 0) {
                    showError('No data to convert');
                    return;
                }
                
                // Flatten all objects
                const flattenedData = data.map(item => flattenObject(item));
                
                // Get all unique keys
                const allKeys = new Set();
                flattenedData.forEach(item => {
                    Object.keys(item).forEach(key => allKeys.add(key));
                });
                const headers = Array.from(allKeys);
                
                // Get delimiter
                const delimiter = document.getElementById('delimiter').value;
                const includeHeaders = document.getElementById('include-headers').checked;
                
                // Build CSV
                let csv = '';
                
                // Add headers
                if (includeHeaders) {
                    csv += headers.map(h => escapeCSVValue(h, delimiter)).join(delimiter) + '\n';
                }
                
                // Add data rows
                flattenedData.forEach(row => {
                    const values = headers.map(header => {
                        return escapeCSVValue(row[header] !== undefined ? row[header] : '', delimiter);
                    });
                    csv += values.join(delimiter) + '\n';
                });
                
                // Display output
                output.value = csv.trim();
                
                // Create table preview
                createTablePreview(headers, flattenedData);
                
                errorDiv.style.display = 'none';
                showNotification('JSON converted to CSV successfully!');
                
            } catch (e) {
                showError('Invalid JSON: ' + e.message);
            }
        }

        function createTablePreview(headers, data) {
            const tablePreview = document.getElementById('table-preview');
            
            if (data.length === 0) {
                tablePreview.style.display = 'none';
                return;
            }
            
            let html = '<table><thead><tr>';
            headers.forEach(header => {
                html += `<th>${escapeHtml(header)}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            // Show max 10 rows in preview
            const previewData = data.slice(0, 10);
            previewData.forEach(row => {
                html += '<tr>';
                headers.forEach(header => {
                    const value = row[header] !== undefined ? row[header] : '';
                    html += `<td>${escapeHtml(String(value))}</td>`;
                });
                html += '</tr>';
            });
            
            if (data.length > 10) {
                html += `<tr><td colspan="${headers.length}" style="text-align: center; font-style: italic;">... and ${data.length - 10} more rows</td></tr>`;
            }
            
            html += '</tbody></table>';
            tablePreview.innerHTML = html;
            tablePreview.style.display = 'block';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function showError(message) {
            const errorDiv = document.getElementById('error-message');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            
            // Clear output
            document.getElementById('output').value = '';
            document.getElementById('table-preview').style.display = 'none';
        }

        function clearAll() {
            document.getElementById('input').value = '';
            document.getElementById('output').value = '';
            document.getElementById('error-message').style.display = 'none';
            document.getElementById('table-preview').style.display = 'none';
        }

        function copyOutput() {
            const output = document.getElementById('output');
            if (!output.value) {
                showNotification('No CSV to copy!', 'error');
                return;
            }
            
            output.select();
            document.execCommand('copy');
            showNotification('CSV copied to clipboard!');
        }

        function downloadCSV() {
            const output = document.getElementById('output').value;
            if (!output) {
                showNotification('No CSV to download!', 'error');
                return;
            }
            
            const blob = new Blob([output], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', 'data.csv');
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('CSV file downloaded!');
        }

        function loadExample(type) {
            const examples = {
                simple: `[
  {
    "name": "Alice Johnson",
    "age": 28,
    "email": "alice@example.com",
    "department": "Engineering"
  },
  {
    "name": "Bob Smith",
    "age": 32,
    "email": "bob@example.com",
    "department": "Marketing"
  },
  {
    "name": "Charlie Brown",
    "age": 24,
    "email": "charlie@example.com",
    "department": "Sales"
  }
]`,
                nested: `[
  {
    "user": "john123",
    "profile": {
      "firstName": "John",
      "lastName": "Doe",
      "address": {
        "city": "New York",
        "country": "USA",
        "zipCode": "10001"
      }
    },
    "isActive": true
  },
  {
    "user": "jane456",
    "profile": {
      "firstName": "Jane",
      "lastName": "Smith",
      "address": {
        "city": "London",
        "country": "UK",
        "zipCode": "SW1A 1AA"
      }
    },
    "isActive": false
  }
]`,
                complex: `[
  {
    "id": 1,
    "product": "Laptop",
    "price": 999.99,
    "tags": ["electronics", "computers", "portable"],
    "specifications": {
      "cpu": "Intel i7",
      "ram": "16GB",
      "storage": "512GB SSD"
    },
    "inStock": true
  },
  {
    "id": 2,
    "product": "Mouse",
    "price": 29.99,
    "tags": ["electronics", "accessories"],
    "specifications": {
      "type": "Wireless",
      "dpi": "1600"
    },
    "inStock": true
  }
]`
            };
            
            document.getElementById('input').value = examples[type];
            setInputFormat('array');
            convertToCSV();
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notification-text');
            
            text.textContent = message;
            notification.style.background = type === 'error' ? '#e74c3c' : '#27ae60';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Auto-convert on input change (with debounce)
        let convertTimeout;
        document.getElementById('input').addEventListener('input', function() {
            clearTimeout(convertTimeout);
            convertTimeout = setTimeout(() => {
                if (this.value.trim()) {
                    convertToCSV();
                }
            }, 500);
        });

        // Process on Ctrl/Cmd + Enter
        document.getElementById('input').addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                convertToCSV();
            }
        });
    </script>
</body>
</html>